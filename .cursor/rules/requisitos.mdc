---
description: 
globs: 
alwaysApply: true
---
---
description: Diretrizes para Desenvolvimento de C√≥digo
globs: 
alwaysApply: true
---
# Relat√≥rio Executivo: Sistema Gest√£o de Faturamento

## 1. Vis√£o Geral do Projeto

O projeto √© um sistema completo para gest√£o de cl√≠nicas de atendimento a crian√ßas autistas, desenvolvido com uma arquitetura moderna que utiliza:

- **Backend**: FastAPI (Python)
- **Frontend**: Next.js 14/React
- **Armazenamento de Arquivos**: Cloudflare R2
- **Extra√ß√£o de Dados**: IA para processamento de documentos (Claude)
- **Automa√ß√£o**: Selenium para integra√ß√£o com sistemas externos
- **Banco de Dados**: Supabase (PostgreSQL)
- **Armazenamento de Arquivos**: Cloudflare R2
- **Cache Local**: Arquivos JSON para otimiza√ß√£o

## 2. Funcionalidades Implementadas

### 2.1. Gest√£o de Pacientes e Atendimentos
- ‚úÖ Cadastro completo de pacientes
- ‚úÖ Gest√£o de carteirinhas
- ‚úÖ Controle de protocolos de atendimento
- ‚úÖ Gerenciamento de guias
- ‚úÖ Registro e controle de fichas de presen√ßa
- ‚úÖ Registro de sess√µes e execu√ß√µes
- ‚úÖ Atendimentos para faturamento

### 2.2. Sistema de Upload e Extra√ß√£o de Dados de PDF
- ‚úÖ Upload de documentos PDF (fichas de pacientes)
- ‚úÖ Extra√ß√£o automatizada de dados com IA (API Claude da Anthropic)
- ‚úÖ Dois modos de funcionamento:
  - **Modo Normal**: Para guias existentes no sistema
  - **Modo Alternativo**: Permite upload mesmo sem guia cadastrada
- ‚úÖ Armazenamento dos PDFs no Cloudflare R2
- ‚úÖ Registro dos dados extra√≠dos no Supabase

### 2.3. Tratamento de Fichas Pendentes
- ‚úÖ Interface para visualizar fichas pendentes
- ‚úÖ Filtros e busca avan√ßada
- ‚úÖ Visualiza√ß√£o do PDF original e dados extra√≠dos
- ‚úÖ Processamento manual com op√ß√µes para criar guia ou vincular a existente
- ‚úÖ Feedback visual sobre o resultado do processamento

### 2.4. Sistema de Armazenamento e Sincroniza√ß√£o
- ‚úÖ Gerenciamento de arquivos digitais (PDFs, imagens, documentos)
- ‚úÖ Armazenamento no Cloudflare R2 com metadados no Supabase
- ‚úÖ Sincroniza√ß√£o bidirecional entre R2 e tabela de storage
- ‚úÖ Interface para visualiza√ß√£o de todos os arquivos armazenados
- ‚úÖ Funcionalidades de upload e exclus√£o de arquivos

### 2.5. Sistema de Scraping Unimed
- ‚úÖ Automa√ß√£o para captura de dados da Unimed
- ‚úÖ Autentica√ß√£o autom√°tica no site da Unimed
- ‚úÖ Captura de sess√µes realizadas com filtro por data
- ‚úÖ Processamento de dados capturados
- ‚úÖ Persist√™ncia no banco de dados local
- ‚úÖ Dashboard de monitoramento
- ‚úÖ Controle de cache para otimiza√ß√£o

### 2.6. Importa√ß√£o de Dados
- ‚úÖ Importa√ß√£o de pacientes do MySQL
- ‚úÖ Mapeamento de IDs entre MySQL e Supabase
- ‚úÖ Importa√ß√£o de agendamentos
- ‚úÖ Logs detalhados de importa√ß√£o

### 2.7. Scripts de Teste
- ‚úÖ Scripts para gera√ß√£o de dados de teste
- ‚úÖ Testes de conex√£o com servi√ßos externos
- ‚úÖ Ambiente de desenvolvimento isolado

## 3. Funcionalidades em Desenvolvimento

### 3.1. Sistema de Auditoria de Diverg√™ncias
- üü° Implementa√ß√£o parcial do sistema para identificar e gerenciar discrep√¢ncias entre fichas f√≠sicas e execu√ß√µes registradas
- üü° Interface para visualiza√ß√£o e corre√ß√£o de diverg√™ncias

### 3.2. Processamento em Lote de Fichas Pendentes
- üü° Sele√ß√£o m√∫ltipla de fichas para processamento em lote
- üü° Automa√ß√£o do processamento para fichas que atendem a crit√©rios espec√≠ficos

## 4. Funcionalidades Pendentes

### 4.1. Auditoria e Relat√≥rios Avan√ßados
- ‚≠ï Relat√≥rios detalhados sobre produtividade
- ‚≠ï Auditoria completa de a√ß√µes dos usu√°rios
- ‚≠ï Estat√≠sticas avan√ßadas de atendimento

### 4.2. Notifica√ß√µes e Alertas
- ‚≠ï Sistema de notifica√ß√µes para usu√°rios
- ‚≠ï Alertas sobre fichas pendentes que precisam de aten√ß√£o
- ‚≠ï Notifica√ß√µes de processos automatizados conclu√≠dos

### 4.3. Melhorias de Usabilidade
- ‚≠ï Refinamento da interface de usu√°rio
- ‚≠ï Otimiza√ß√£o para dispositivos m√≥veis
- ‚≠ï Tutoriais interativos para novos usu√°rios

## 5. Arquitetura e Estrutura de Dados

### 5.1. Principais Entidades
- **PACIENTES**: Cadastro completo de pacientes
- **CARTEIRINHAS**: Documentos de identifica√ß√£o dos pacientes
- **PROTOCOLOS**: Protocolos de atendimento
- **GUIAS**: Guias de autoriza√ß√£o para procedimentos
- **PROCEDIMENTOS**: Procedimentos m√©dicos
- **FICHAS**: Fichas de presen√ßa
- **SESSOES**: Registros de sess√µes realizadas
- **EXECUCOES**: Detalhes de execu√ß√£o de procedimentos
- **ATENDIMENTOS_FATURAMENTO**: Dados para faturamento

## 8. Pr√≥ximos Passos Recomendados

1. **Finaliza√ß√£o do Sistema de Auditoria de Diverg√™ncias**
   - Implementa√ß√£o completa do m√≥dulo de auditoria
   - Testes com dados reais da cl√≠nica

2. **Implementa√ß√£o do Processamento em Lote**
   - Automa√ß√£o para processamento de m√∫ltiplas fichas
   - Regras de neg√≥cio para processamento autom√°tico

3. **Desenvolvimento de Relat√≥rios Avan√ßados**
   - Relat√≥rios gerenciais
   - Estat√≠sticas de produtividade
   - Indicadores de desempenho

4. **Sistema de Notifica√ß√µes**
   - Alertas para usu√°rios
   - Notifica√ß√µes de processos conclu√≠dos
   - Lembretes de tarefas pendentes

5. **Refinamento da Interface**
   - Melhorias de usabilidade
   - Otimiza√ß√£o para dispositivos m√≥veis
   - Personaliza√ß√£o da experi√™ncia do usu√°rio

---


